name: Pre-Deploy - Verify Railway Service (Reusable)

# NOTE: Team tokens cannot create services via CLI.
# Services must be created manually in Railway dashboard first.

on:
  workflow_call:
    inputs:
      service:
        description: "Railway service name to verify"
        required: true
        type: string
      environment:
        description: "Target environment"
        required: true
        type: string
    secrets:
      RAILWAY_TOKEN:
        required: true

jobs:
  verify-service:
    name: Verify Service
    runs-on: ubuntu-latest
    env:
      RAILWAY_TOKEN: ${{ secrets.RAILWAY_TOKEN }}
    steps:
      - name: Verify service exists
        run: |
          echo "## Pre-Deploy Verification" >> $GITHUB_STEP_SUMMARY
          echo "- **Environment:** ${{ inputs.environment }}" >> $GITHUB_STEP_SUMMARY
          echo "- **Service:** ${{ inputs.service }}" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "Note: Railway services must be created manually in the dashboard." >> $GITHUB_STEP_SUMMARY
          echo "The deploy step will attempt to deploy to the specified service." >> $GITHUB_STEP_SUMMARY
